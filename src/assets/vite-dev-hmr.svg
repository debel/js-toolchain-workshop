<svg viewBox="0 0 650 550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>
  
  <style>
    .title { font-size: 20px; font-weight: bold; fill: #333; }
    .hook { fill: #FFD54F; stroke: #F57C00; stroke-width: 2; }
    .process { fill: #90CAF9; stroke: #1976D2; stroke-width: 2; }
    .tool { fill: #A5D6A7; stroke: #388E3C; stroke-width: 2; }
    .event { fill: #FFAB91; stroke: #E64A19; stroke-width: 2; }
    .label { font-size: 13px; fill: #333; text-anchor: middle; }
    .small { font-size: 10px; fill: #666; text-anchor: middle; }
  </style>
  
  <text x="325" y="30" class="title" text-anchor="middle">DEV MODE - Phase 3: Hot Module Replacement</text>
  
  <!-- File change detected -->
  <rect x="245" y="60" width="160" height="50" rx="5" class="event"/>
  <text x="325" y="80" class="label" font-weight="bold">File Changed!</text>
  <text x="325" y="95" class="small">Detected by chokidar</text>
  
  <line x1="325" y1="110" x2="325" y2="135" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Tool: chokidar -->
  <rect x="245" y="140" width="160" height="40" rx="5" class="tool"/>
  <text x="325" y="165" class="label" font-weight="bold">üîç chokidar</text>
  
  <line x1="325" y1="180" x2="325" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Plugin Hook: handleHotUpdate -->
  <rect x="245" y="205" width="160" height="40" rx="5" class="hook"/>
  <text x="325" y="230" class="label" font-weight="bold">üîå handleHotUpdate</text>
  
  <line x1="325" y1="245" x2="325" y2="265" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Invalidate module graph -->
  <rect x="245" y="270" width="160" height="50" rx="5" class="process"/>
  <text x="325" y="290" class="label">Invalidate Module</text>
  <text x="325" y="305" class="small">Clear transform cache</text>
  
  <line x1="325" y1="320" x2="325" y2="340" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Find affected modules -->
  <rect x="245" y="345" width="160" height="50" rx="5" class="process"/>
  <text x="325" y="365" class="label">Find Affected Modules</text>
  <text x="325" y="380" class="small">Walk import graph</text>
  
  <line x1="325" y1="395" x2="325" y2="415" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Create HMR payload -->
  <rect x="245" y="420" width="160" height="45" rx="5" class="process"/>
  <text x="325" y="440" class="label">Create HMR Payload</text>
  <text x="325" y="455" class="small">{ type, path, timestamp }</text>
  
  <line x1="325" y1="465" x2="325" y2="485" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Send via WebSocket -->
  <rect x="245" y="490" width="160" height="40" rx="5" class="tool"/>
  <text x="325" y="515" class="label" font-weight="bold">üì° WebSocket</text>
  
  <!-- Browser side -->
  <rect x="450" y="140" width="180" height="370" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="540" y="165" style="font-size: 14px; font-weight: bold; fill: #1976D2; text-anchor: middle;">Browser Client</text>
  
  <rect x="470" y="185" width="140" height="35" rx="5" fill="#BBDEFB" stroke="#1976D2" stroke-width="1"/>
  <text x="540" y="207" style="font-size: 12px; fill: #333; text-anchor: middle;">Receive Update</text>
  
  <line x1="540" y1="220" x2="540" y2="240" stroke="#1976D2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="470" y="245" width="140" height="35" rx="5" fill="#BBDEFB" stroke="#1976D2" stroke-width="1"/>
  <text x="540" y="267" style="font-size: 12px; fill: #333; text-anchor: middle;">Fetch New Module</text>
  
  <line x1="540" y1="280" x2="540" y2="300" stroke="#1976D2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="470" y="305" width="140" height="45" rx="5" fill="#BBDEFB" stroke="#1976D2" stroke-width="1"/>
  <text x="540" y="322" style="font-size: 11px; fill: #333; text-anchor: middle;">Re-transform via</text>
  <text x="540" y="337" style="font-size: 11px; fill: #333; text-anchor: middle;">Transform Pipeline</text>
  
  <line x1="540" y1="350" x2="540" y2="370" stroke="#1976D2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <rect x="470" y="375" width="140" height="35" rx="5" fill="#BBDEFB" stroke="#1976D2" stroke-width="1"/>
  <text x="540" y="397" style="font-size: 12px; fill: #333; text-anchor: middle;">Apply Update</text>
  
  <line x1="540" y1="410" x2="540" y2="430" stroke="#1976D2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <ellipse cx="540" cy="460" rx="60" ry="25" fill="#81C784" stroke="#2E7D32" stroke-width="2"/>
  <text x="540" y="467" style="font-size: 12px; fill: #333; text-anchor: middle;">UI Updated</text>
  
  <!-- Connection arrow -->
  <path d="M 405,510 L 470,205" stroke="#FF6F00" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrow)"/>
  <text x="435" y="350" style="font-size: 11px; fill: #FF6F00;" transform="rotate(-70 435 350)">WebSocket</text>
  
  <!-- Legend -->
  <rect x="20" y="400" width="150" height="120" rx="5" fill="#F5F5F5" stroke="#999" stroke-width="1"/>
  <text x="95" y="420" style="font-size: 12px; font-weight: bold; fill: #333; text-anchor: middle;">Legend</text>
  <rect x="30" y="430" width="35" height="16" class="hook"/>
  <text x="70" y="441" style="font-size: 10px; fill: #333;">Plugin Hook</text>
  <rect x="30" y="451" width="35" height="16" class="process"/>
  <text x="70" y="462" style="font-size: 10px; fill: #333;">Process</text>
  <rect x="30" y="472" width="35" height="16" class="tool"/>
  <text x="70" y="483" style="font-size: 10px; fill: #333;">Tool Used</text>
  <rect x="30" y="493" width="35" height="16" class="event"/>
  <text x="70" y="504" style="font-size: 10px; fill: #333;">Event</text>
</svg>
